<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: JavaScript | TJ VanToll]]></title>
  <link href="http://tjvantoll.com/blog/categories/javascript/atom.xml" rel="self"/>
  <link href="http://tjvantoll.com/"/>
  <updated>2013-06-20T22:02:20-04:00</updated>
  <id>http://tjvantoll.com/</id>
  <author>
    <name><![CDATA[TJ VanToll]]></name>
    <email><![CDATA[tj.vantoll@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Using Semantic Class Names to Show and Hide Elements]]></title>
    <link href="http://tjvantoll.com/2013/06/19/using-semantic-class-names-to-show-and-hide-elements/"/>
    <updated>2013-06-19T21:29:00-04:00</updated>
    <id>http://tjvantoll.com/2013/06/19/using-semantic-class-names-to-show-and-hide-elements</id>
    <content type="html"><![CDATA[<p>Showing and hiding elements has the potential to get complicated in large applications.</p>

<p>As a small example, say you have the following form that both displays a user's data as well as allows them to edit it:</p>

<p>``` html
<form></p>

<pre><code>&lt;fieldset&gt;
    &lt;legend&gt;Account Information&lt;/legend&gt;

    &lt;div&gt;
        &lt;label for="name"&gt;Name:&lt;/label&gt;
        &lt;input type="text" id="name" value="TJ" required&gt;
        &lt;span class="display"&gt;TJ&lt;/span&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;label for="email"&gt;Email:&lt;/label&gt;
        &lt;input type="email" id="email" value="tj@somedomain.com" required&gt;
        &lt;span class="display"&gt;tj@somedomain.com&lt;/span&gt;
    &lt;/div&gt;
    &lt;div class="actions"&gt;
        &lt;button type="button" class="edit"&gt;Edit&lt;/button&gt;
        &lt;button type="submit" class="save"&gt;Save&lt;/button&gt;
        &lt;button type="button" class="cancel"&gt;Cancel&lt;/button&gt;
    &lt;/div&gt;
&lt;/fieldset&gt;
</code></pre>

<p></form>
```</p>

<!-- more -->


<p>Without any logic both states of the form display:</p>

<p><div class="code_example"><h6>Initial Form Display<a href="/demos/2013-06-19/initialForm.html" target="_blank">Open in New Window</a></h6><iframe style="width: 100%; height: 300px;" frameborder="0" src="/demos/2013-06-19/initialForm.html"></iframe></div></p>

<h3>Adding the Logic</h3>

<p>Here's the goal. The Edit button should:</p>

<ul>
<li>Show the <code>&lt;input&gt;</code>s.</li>
<li>Show the Save button.</li>
<li>Show the Cancel button.</li>
<li>Hide the Edit button.</li>
<li>Hide the text in the <code>&lt;span&gt;</code>s.</li>
</ul>


<p>The Cancel button should then undo these changes.</p>

<p>The traditional approach to this problem is to show and hide elements explicitly in JavaScript:</p>

<p>``` javascript
$( ".edit" ).on( "click", function() {</p>

<pre><code>$( ".display, .edit" ).hide();
$( ".cancel, .save, input" ).show();
</code></pre>

<p>});
$( ".cancel" ).on( "click", function() {</p>

<pre><code>$( ".display, .edit" ).show();
$( ".cancel, .save, input" ).hide();
</code></pre>

<p>});
```</p>

<p>To get the initial state of the form correct you also need some CSS:</p>

<p>``` css
.cancel, .save, input {</p>

<pre><code>display: none;
</code></pre>

<p>}
```</p>

<p>Because the list of elements has to be specified in JavaScript and CSS, this logic will be difficult to maintain. And this is for a trivial example; usually requirements are much more complex.</p>

<p>How can we make this better?</p>

<h3>Semantic Class Names</h3>

<p>Instead of targeting individual elements in JavaScript, let's add a class name to the parent element that makes the most sense, in this case, the <code>&lt;form&gt;</code>:</p>

<p>``` javascript
$( ".edit" ).on( "click", function() {</p>

<pre><code>$( this ).parents( "form" ).addClass( "editing" );
</code></pre>

<p>});
$( ".cancel" ).on( "click", function() {</p>

<pre><code>$( this ).parents( "form" ).removeClass( "editing" );
</code></pre>

<p>});
```</p>

<p>Since the logic is simple, this can be written library-free as well (<em>note <code>classList</code> is not available in IE &lt; 10</em>):</p>

<p>``` javascript
(function() {</p>

<pre><code>var form = document.querySelector( "form" ),
    editButton = document.querySelector( ".edit" ),
    cancelButton = document.querySelector( ".cancel" );

editButton.addEventListener( "click", function() {
    form.classList.add( "editing" ); 
});
cancelButton.addEventListener( "click", function() {
    form.classList.remove( "editing" ); 
});
</code></pre>

<p>}());
```</p>

<h3>Advantages of Using Semantic Classes</h3>

<p>There are 2 major advantages to this approach.</p>

<p>1) All display logic is now handled in CSS:</p>

<p>``` css
.cancel, .save, input {</p>

<pre><code>display: none;
</code></pre>

<p>}
.editing .save,
.editing .cancel,
.editing input {</p>

<pre><code>display: inline-block;
</code></pre>

<p>}
.editing .edit,
.editing .display {</p>

<pre><code>display: none;
</code></pre>

<p>}
```</p>

<p>2) You have a styling hook that can be used to make further changes to the display. For example, you might want to bold the labels when editing:</p>

<p>``` css
.editing label {</p>

<pre><code>font-weight: bold;
</code></pre>

<p>}
```</p>

<p>The final display of the form looks like this:</p>

<p><div class="code_example"><h6>Semantic Class Approach<a href="/demos/2013-06-19/finalForm.html" target="_blank">Open in New Window</a></h6><iframe style="width: 100%; height: 300px;" frameborder="0" src="/demos/2013-06-19/finalForm.html"></iframe></div></p>

<h3>Conclusion</h3>

<p>This is not a technique that I came up with but I've used it successfully in several large applications and have found that it scales well over time.</p>

<p>Do you have any other tricks you use to show &amp; hide elements? If so, let me know in the comments.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Showing a Resize Icon on a jQuery UI Dialog]]></title>
    <link href="http://tjvantoll.com/2013/05/28/showing-a-resize-icon-on-a-jquery-ui-dialog/"/>
    <updated>2013-05-28T21:09:00-04:00</updated>
    <id>http://tjvantoll.com/2013/05/28/showing-a-resize-icon-on-a-jquery-ui-dialog</id>
    <content type="html"><![CDATA[<p>Upon <a href="http://jqueryui.com/upgrade-guide/1.10/">upgrading to jQuery UI 1.10</a> you might notice a visual change to the dialog widget - the resize icon no longer displays by default:</p>

<p>Default dialog display in 1.9:</p>

<p><img src="http://tjvantoll.com/images/posts/2013-05-28/dialog-1.9.png" alt="Default display of jQuery UI's dialog in version 1.9"></p>

<p>Default dialog display in 1.10:</p>

<p><img src="http://tjvantoll.com/images/posts/2013-05-28/dialog-1.10.png" alt="Default display of jQuery UI's dialog in version 1.10"></p>

<!-- more -->


<p>The dialog is still resizable, the icon is just not displayed anymore. The change was made because when a dialog contains scrolling content, the scrollbar becomes very difficult to use when the resize icon is present, especially in Windows browsers (see <a href="http://bugs.jqueryui.com/ticket/4575">bug #4575</a>).</p>

<p>The image below is of a version 1.9 dialog in IE9, note how the down arrow of the scrollbar and the resize icon are essentially on top of each other:</p>

<p><img src="http://tjvantoll.com/images/posts/2013-05-28/ie9-dialog.png" alt="Display of a scrolling jQuery UI dialog in IE9."></p>

<h3>Adding the Resize Icon Back</h3>

<p>To get the icon back, you have to override the rules that position the icon:</p>

<p>``` css
.ui-dialog .ui-resizable-se {</p>

<pre><code>width: 14px;
height: 14px;
right: 3px;
bottom: 3px;
background-position: -80px -224px;
</code></pre>

<p>}
```</p>

<p>This will display as follows:</p>

<p><div class="code_example"><h6>Dialog with a Resizable Icon<a href="/demos/2013-05-28/dialog.html" target="_blank">Open in New Window</a></h6><iframe style="width: 100%; height: 300px;" frameborder="0" src="/demos/2013-05-28/dialog.html"></iframe></div></p>

<p>Remember that there is a reason the icon was removed from the default dialog. If you have scrolling dialogs, you should not add the icon.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Why are Enter Keypresses Clicking My Buttons in IE?]]></title>
    <link href="http://tjvantoll.com/2013/05/22/why-are-enter-keypresses-clicking-my-buttons-in-ie/"/>
    <updated>2013-05-22T22:15:00-04:00</updated>
    <id>http://tjvantoll.com/2013/05/22/why-are-enter-keypresses-clicking-my-buttons-in-ie</id>
    <content type="html"><![CDATA[<p>When you press the Enter key in a textbox, the browser will automatically attempt to perform an <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/association-of-controls-and-forms.html#implicit-submission">implicit submission</a> of the textbox's <code>&lt;form&gt;</code>.</p>

<p>For example, if you press Enter in the textbox of the following <code>&lt;form&gt;</code> it will submit a search query to Google:</p>

<p>``` html
<form action="http://google.com"></p>

<pre><code>&lt;input name="q" type="text"&gt;
&lt;input type="submit"&gt;
</code></pre>

<p></form>
```</p>

<!--more-->


<p>The same will occur if you use a <code>&lt;button&gt;</code> element, which has a default <code>type</code> of <code>submit</code>:</p>

<p>``` html
<form action="http://google.com"></p>

<pre><code>&lt;input name="q" type="text"&gt;
&lt;button&gt;Submit&lt;/button&gt;
</code></pre>

<p></form>
```</p>

<p>In each of these examples a <code>click</code> event will be triggered on the form's <code>input[type="submit"]</code> / <code>button[type="submit"]</code>. This is all expected and speced behavior that is consistently implemented across browsers.</p>

<h3>Internet Explorer</h3>

<p>Internet Explorer has an annoying quirk that still exists as of IE10: submit buttons can be clicked when Enter is pressed in a textbox, even when no <code>&lt;form&gt;</code> is present. Consider the example below:</p>

<p>``` html
<input type="text"></p>

<!-- other stuff -->


<p><button>Some Unrelated Action</button>
```</p>

<p>Pressing Enter in this textbox in IE will click the completely unrelated <code>&lt;button&gt;</code>. No other browsers exhibit this behavior.</p>

<p>I have no idea what IE's algorithm for selecting a submit button is, but it will find buttons in completely unrelated portions of the DOM. For instance it is responsible for a <a href="http://bugs.jqueryui.com/ticket/9312">jQuery UI bug</a> by causing a dialog's close button to be triggered on enter keypresses in unrelated textboxes.</p>

<h3>Solution</h3>

<p>All <code>&lt;input&gt;</code>s should be within a <code>&lt;form&gt;</code>, and all forms should have a submit button. So if you're running into this bug, changing your markup to be semantic will avoid this issue altogether.</p>

<p>If for whatever reason that's not an option, you can add <code>type="button"</code> to the <code>&lt;button&gt;</code>:</p>

<p>``` html
<input type="text"></p>

<!-- other stuff -->


<p><button type="button">Some Unrelated Action</button>
```</p>

<p>This will override the default <code>type="submit"</code> and prevent IE from clicking the <code>&lt;button&gt;</code> on Enter keypresses.</p>

<p>If anybody has knowledge of the algorithm IE uses to find submittable elements when no <code>&lt;form&gt;</code>s are present please let me know in the comments. I'm very curious.</p>

<h4>Related Reading</h4>

<ul>
<li><a href="/2013/01/01/enter-should-submit-forms-stop-messing-with-that/">The Enter Key should Submit Forms, Stop Suppressing it</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Using Ternary Operators for More Maintainable Templates]]></title>
    <link href="http://tjvantoll.com/2013/04/26/using-ternary-operators-for-more-maintainable-templates/"/>
    <updated>2013-04-26T00:00:00-04:00</updated>
    <id>http://tjvantoll.com/2013/04/26/using-ternary-operators-for-more-maintainable-templates</id>
    <content type="html"><![CDATA[<p>With the rise of JavaScript MVC frameworks, writing templates has become a large part of many web developer's workflow. As such, I thought I'd share a tip that has made my templates far more readable and maintainable over the years, ternary operators.<!-- http://jsbin.com/ekiwal/3/edit --></p>

<p><i>Note: For my examples I'm using <a href="http://underscorejs.org/#template">Underscore's templates</a>, but this same tip applies to any templating language, even traditional server side ones like PHP.</i></p>

<!-- more -->


<h3>Example</h3>

<p>Let's say you have the following data for your application:</p>

<p>``` javascript
var items = [</p>

<pre><code>{ name: 'Clock', selected: false },
{ name: 'Chair', selected: false },
{ name: 'Radio', selected: true }
</code></pre>

<p>];
```</p>

<p>And you want to run this data through a template to generate an HTML list. You might start with something like this:</p>

<p>``` html</p>

<ul>
    <% _.each( items, function( item ) { %>
        <li>
            <%- item.name %>
        </li>
    <% }); %>
</ul>


<p>```</p>

<p>This works fine.  But chances are, for a real application you'll need to do something significantly more complicated than this.  As a first step, let's say you have to add a CSS hook for selected items. You could accomplish that with an if check around each list item:</p>

<p>``` html</p>

<ul>
    <% _.each( items, function( item ) { %>
        <% if ( item.selected ) { %>
            <li class="selected">
        <% } else { %>
            <li>
        <% } %>
            <%- item.name %>
        </li>
    <% }); %>
</ul>


<p>```</p>

<p>Unfortunately this adds 4 lines of code and some unfortunate indentation just to add a simple class. Another alternative is to put the if check within the attribute:</p>

<p>``` html</p>

<ul>
    <% _.each( items, function( item ) { %>
        <li class="<% if ( item.selected ) { %>selected<% } %>">
            <%- item.name %>
        </li>
    <% }); %>
</ul>


<p>```</p>

<p>This isn't bad, but personally I find this code difficult to scan. I prefer to handle this situation with a ternary operator:</p>

<p>``` html</p>

<ul>
    <% _.each( items, function( item ) { %>
        <li class="<%= (item.selected) ? 'selected' : '' %>">
            <%- item.name %>
        </li>
    <% }); %>
</ul>


<p>```</p>

<p>Yes this is a stylistic thing, but I find this clearer and more readable. This will produce an unnecessary empty class attribute on non-selected items, but I believe the readability of the code to be far more important.</p>

<p>For added fun, ternary operators can be nested. Say your application now has to handle deleted items:</p>

<p>``` javascript
var items = [</p>

<pre><code>{ name: 'Clock', selected: false, deleted: true },
{ name: 'Chair', selected: false, deleted: false },
{ name: 'Radio', selected: true, deleted: false }
</code></pre>

<p>];
```</p>

<p>The following template shows how nested ternaries could be used to handle either a selected or deleted hook:</p>

<p><i>Note: This assumes that the selected and deleted states will not occur at the same time.</i></p>

<p>``` html</p>

<ul>
    <% _.each( items, function( item ) { %>
        <li class="<%= (item.selected) ? 'selected' :
                       (item.deleted) ? 'deleted' : '' %>">
            <%- item.name %>
        </li>
    <% }); %>
</ul>


<p>```</p>

<p>Here are a couple other examples of how you could structure this check. The most important thing is to find something that works for you, or more importantly, the person who will be maintaining your code.</p>

<p>``` html</p>

<ul>
    <% _.each( items, function( item ) { %>
        <li class="<% if (item.selected) { %>selected<% } %>
                   <% if (item.deleted) { %>deleted<% } %>">
            <%- item.name %>
        </li>
    <% }); %>
</ul>


<p>```</p>

<p>``` html</p>

<ul>
    <% _.each( items, function( item ) { %>
        <li class="
          <% if (item.selected) { %> selected <% } %>
          <% if (item.deleted)  { %> deleted  <% } %>
        ">
            <%- item.name %>
        </li>
    <% }); %>
</ul>


<p>```</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Better Ways of Comparing a JavaScript String to Multiple Values]]></title>
    <link href="http://tjvantoll.com/2013/03/14/better-ways-of-comparing-a-javascript-string-to-multiple-values/"/>
    <updated>2013-03-14T00:00:00-04:00</updated>
    <id>http://tjvantoll.com/2013/03/14/better-ways-of-comparing-a-javascript-string-to-multiple-values</id>
    <content type="html"><![CDATA[<p>This is a seemingly simple programming task that we deal with everyday.  Here's the situation:</p>

<ul>
<li>1) You have a string in JavaScript, like <code>var fruit = ''</code>.</li>
<li>2) You need to know if that string is equal to one of multiple values, say <code>"banana"</code> or <code>"lemon"</code> (because the yellow fruits need special yellow fruit processing or something).</li>
</ul>


<p>Most people accomplish this by doing two string comparisons connected by a logical OR, which looks like this:</p>

<p>``` javascript
if (fruit == 'banana' || fruit == 'lemon') {</p>

<pre><code>handleYellowFruit();
</code></pre>

<p>}
```</p>

<p>Which works fine, but is a bit clunky.  I mean, you have to type <code>fruit ==</code> two whole times.  It also doesn't scale well.  Say your fruit processing product takes off and you need to support more fruit, now you have this:</p>

<p>``` javascript
if (fruit == 'banana' || fruit == 'lemon' || fruit == 'mango' || fruit == 'pineapple') {</p>

<pre><code>handleYellowFruit();
</code></pre>

<p>}
```</p>

<!--more-->


<p>This is getting a bit ugly.  Let's look at some other ways of accomplishing the same check.</p>

<h3>Switch</h3>

<p>The switch statement can be used to achieve the same ends:</p>

<p>``` javascript
switch (fruit) {</p>

<pre><code>case 'banana':
case 'lemon':
case 'mango':
case 'pineapple':
    handleYellowFruit();
</code></pre>

<p>}
```</p>

<p>This approach would be helpful if we have to handle for multiple classifications of fruits.  But for one check it's a lot of typing and takes up a lot of space.</p>

<h3>Array Based</h3>

<p>ECMAScript 5 introduced an <code>indexOf</code> method on <code>Array.prototype</code> (<a href="https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/indexOf">docs</a>).  We can use this to create an array on the fly, then see whether the value matches one of the values in the array:</p>

<p>```javascript
if (['banana', 'lemon', 'mango', 'pineapple'].indexOf(fruit) >= 0) {</p>

<pre><code>handleYellowFruit();
</code></pre>

<p>}
```</p>

<p>This is better, but still not ideal.  Understanding this code relies on the reader knowing that the <code>indexOf</code> method returns <code>-1</code>, which is not necessarily common knowledge.</p>

<p>Also, because <code>Array.prototype.indexOf</code> was added in ECMAScript 5, it's not present in IE &lt;= 8.  Therefore, if you're supporting IE &lt;= 8, you either need to add an <code>indexOf</code> method to the prototype yourself or use a library.</p>

<p>Speaking of libraries, most provide a cross browser means of finding values in an array.</p>

<h4>jQuery</h4>

<p><a href="http://jquery.com">jQuery</a> provides an <code>inArray</code> method (<a href="http://api.jquery.com/jQuery.inArray/">docs</a>):</p>

<p>``` javascript
if ($.inArray(fruit, ['banana', 'lemon', 'mango', 'pineapple']) >= 0) {</p>

<pre><code>handleYellowFruit();
</code></pre>

<p>}
```</p>

<h4>Underscore</h4>

<p><a href="http://underscorejs.org">Underscore.js</a> provides a <code>contains</code> method (<a href="http://underscorejs.org/#contains">docs</a>):</p>

<p>``` javascript
if (_.contains(['banana', 'lemon', 'mango', 'pineapple'], fruit)) {</p>

<pre><code>handleYellowFruit();
</code></pre>

<p>}
```</p>

<p>Other libraries provide similar methods.  Personally, I find Underscore's API to be the cleanest.  The contains API intuitively returns a boolean and there's not much to type.  You might however find yourself needing to remember the order of the parameters (does the array come first or the value?).</p>

<p>The check would be cleaner if the <code>contains</code> method were added to <code>Array.prototype</code> directly:</p>

<p>``` javascript
Array.prototype.contains = function(obj) {</p>

<pre><code>return this.indexOf(obj) &gt; -1;
</code></pre>

<p>};
```</p>

<p>This allows the check to be:</p>

<p>``` javascript
if (['banana', 'lemon', 'mango', 'pineapple'].contains(fruit)) {</p>

<pre><code>handleYellowFruit();
</code></pre>

<p>}
```</p>

<h3>Regular Expressions</h3>

<p>An often overlooked means of performing this check is to use regular expressions via <code>String.prototype.match</code> (<a href="https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String">docs</a>).</p>

<p>``` javascript
if (fruit.match(/<sup>(banana|lemon|mango|pineapple)$/))</sup> {</p>

<pre><code>handleYellowFruit();
</code></pre>

<p>}
```</p>

<p>This check clearly requires the least amount of typing.  It is also the most flexible as you can easily alter things like case sensitivity, special character handling, white space, etc.  This will work in all browsers and you don't have to worry about messing with the native prototypes.</p>

<p>While this is the most powerful option, it comes at a cost of being less readable.  I had to look up the <code>^</code> (match at the beginning of input) and <code>$</code> (match at the end of input) characters when writing this post.</p>
]]></content>
  </entry>
  
</feed>
